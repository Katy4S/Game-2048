!function(){"use strict";var t=new(function(){"use strict";var t;function e(){if(!(this instanceof e))throw TypeError("Cannot call a class as a function");this.board=this.createEmptyBoard(),this.score=0,this.status="idle"}return t=[{key:"getState",value:function(){return this.board}},{key:"getScore",value:function(){return this.score}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addNewTile(),this.addNewTile()}},{key:"restart",value:function(){this.start()}},{key:"createEmptyBoard",value:function(){return Array.from({length:4},function(){return[,,,,].fill(0)})}},{key:"addNewTile",value:function(){var t=this.getEmptyCells();if(t.length){var e=t[Math.floor(Math.random()*t.length)],r=e.r,n=e.c;this.board[r][n]=.9>Math.random()?2:4}}},{key:"getEmptyCells",value:function(){return this.board.flatMap(function(t,e){return t.map(function(t,r){return 0===t?{r:e,c:r}:null})}).filter(Boolean)}},{key:"moveLeft",value:function(){var t=this;return this.shiftTiles(function(e){return t.mergeRow(e)})}},{key:"moveRight",value:function(){var t=this;return this.shiftTiles(function(e){return t.mergeRow(e.slice().reverse()).reverse()})}},{key:"moveUp",value:function(){this.transposeBoard();var t=this.moveLeft();return this.transposeBoard(),t}},{key:"moveDown",value:function(){this.transposeBoard();var t=this.moveRight();return this.transposeBoard(),t}},{key:"shiftTiles",value:function(t){var e=!1,r=this.board.map(function(r){var n=t(r);return JSON.stringify(r)!==JSON.stringify(n)&&(e=!0),n});return e&&(this.board=r,this.addNewTile(),this.checkGameOver()),e}},{key:"mergeRow",value:function(t){for(var e=t.filter(function(t){return 0!==t}),r=[],n=0;n<e.length;n++)e[n]===e[n+1]?(r.push(2*e[n]),this.score+=2*e[n],n++):r.push(e[n]);for(;r.length<4;)r.push(0);return r}},{key:"transposeBoard",value:function(){var t=this;this.board=this.board[0].map(function(e,r){return t.board.map(function(t){return t[r]})})}},{key:"checkGameOver",value:function(){this.board.some(function(t){return t.includes(2048)})?this.status="win":0!==this.getEmptyCells().length||this.canMerge()||(this.status="lose")}},{key:"canMerge",value:function(){var t=this;return this.board.some(function(e,r){return e.some(function(n,o){return 0!==n&&(o<3&&n===e[o+1]||r<3&&n===t.board[r+1][o])})})}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}()),e=document.querySelector(".button.start"),r=document.querySelector(".game-score"),n=document.querySelector(".game-field"),o=document.querySelector(".message-win"),s=document.querySelector(".message-lose"),a=document.querySelector(".message-start");function i(){r.textContent=t.getScore(),t.getState().forEach(function(t,e){return t.forEach(function(t,r){var o;(o=n.rows[e].cells[r]).className="field-cell",t?(o.classList.add("field-cell--".concat(t)),o.textContent=t):o.textContent=""})}),o.classList.toggle("hidden","win"!==t.getStatus()),s.classList.toggle("hidden","lose"!==t.getStatus())}document.addEventListener("keydown",function(e){var r=e.key;if("playing"===t.getStatus()){var n={ArrowLeft:function(){return t.moveLeft()},ArrowRight:function(){return t.moveRight()},ArrowUp:function(){return t.moveUp()},ArrowDown:function(){return t.moveDown()}};n[r]&&n[r]()&&i()}}),e.addEventListener("click",function(){"idle"===t.getStatus()||"lose"===t.getStatus()||"win"===t.getStatus()?(t.start(),a.classList.add("hidden"),e.textContent="Restart",e.classList.add("restart")):t.restart(),i()}),i()}();
//# sourceMappingURL=Game-2048.b645dc90.js.map
